
                    $tmp = read-host press enter to start the listener
                    $str = 300
                    $ostr = $str
                    $end = 310
                    write-host "creating jobs..." -foregroundcolor cyan
                    while ($str -le $end)
                    {
                        $scr = {
                            param($p = $args[1])
                            $lis = new-object system.net.ipendpoint([ipaddress]::any, $p)
                            $sock = new-object system.net.sockets.tcplistener $lis
                            $sock.start()
                            $cli = $sock.accepttcpclient()
                            $tar = $cli.client.remoteendpoint
                            $me = $cli.client.localendpoint
                            $me = $me -split (':')
                            $tar = $tar -split (':')
                            write-host "$($tar[0]) connected to $($me[0])" -foregroundcolor yellow
                            Write-Host "[$($tar[1])] ===egress===>> [$($me[1])]" -foregroundcolor yellow
                            $sock.stop()
                        }
                        start-job -scriptblock $scr -name $str -ArgumentList $str |out-null
                        $str++
                    }
                    write-host "listening from $ostr to $end"
                    $x = 0
                    $i = $ostr


                    while ($true)
                    {
                        if ((get-job -name $i).state -eq "Completed")
                        {
                            Receive-Job -name $i
                        }
                        $i++
                        if ($i -ge $end)
                        {
                            $i=$ostr
                        }
                    }

                    
